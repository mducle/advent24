input = [ ...
'.........#...................................................................................................#.................#..';
'...........................#.......................................#..............................................................';
'.............#.................................................................................#............................#.....';
'...#.....................#.......#....................................#..............#.............................#...........#.#';
'..........#.....#..#.....#.............#..................#............#.....#........#.#.......#............................#....';
'...#...................#..........#...................#.........#..#..............##.......................................#......';
'..................................................................................................#...............................';
'...............#.........#....#.#..#.........#...........#...#....................#.........#.......#....#........................';
'..........................................#......#.#...................................................#.............#............';
'....................#............................#..........................................#.....................#.........#.....';
'..............#..................................#................#..#...........................................#................';
'.........#....###.......#........................................................................................#.#.....#...#..#.';
'.#....................................#.....................................#.................................#..................#';
'........................#...................................#.#....................#......##.#.........#..........................';
'............#.......#..................#..........................................................................................';
'....#.............#.#.....#...#.....#......................#...............#............##...#....................................';
'...#....#.....................................##........#........#....##.....................................#....................';
'...........................................................................#........#..........##................................#';
'..............................#.#......................#..........................#..#........#...............................#...';
'..............#.........###.......................................#...........#...............#......#.........#........#.....#...';
'............#............................#....................#........................#............#.............................';
'.........................................#.....................................................#.....#...............#............';
'.#...##.......................#.......#..........................................................................#...#...........#';
'....#..............#............#......#........................#.......................#...#.......................#.............';
'.......#...............#......#......#..........................................#..................#....................#...#.....';
'.......................................................................#.........#................................................';
'.#.......#........................................................##..............................................................';
'.........................#...................#..#......##..................................#......#......#........................';
'......................................#..............................................#......#..........#.#.........#..............';
'.....#..............#..#........#..............................#...##.............................................................';
'..##............................#.......................................................#..........#..............................';
'...........................................................##................................................#....................';
'#...............#.........#.....................................................#......................###........................';
'#.#.......................#........................#..#.....................#....#........#........................#...#.........#';
'............#.............#.#............#........................#..........#....................................................';
'............#...................#.....................................................................................#.......#...';
'.............................#...#..#...........................#...#.........................................................#...';
'........#.......................##..........................................................#.........#.....................#.....';
'............##............#..........................................................#.#.....#......#.#.......#...................';
'...........#.....#......#.................#.............#......................................#.....#...#........................';
'#............#.........#.......##.....#......#...........#...........#.......#................#...................................';
'......#..#...#.....#................................................#............#...#..........^.................................';
'............................................................................................................#....#................';
'......................................#.............................#........................#...............#.....#...#..........';
'...#.........................................................................#....................................................';
'.....................................#.........................................................#.............#.........#..........';
'#..............................#...#.................................#............................................................';
'..........#..................#............#.......#...........................#...................#.....#.........................';
'............................#...##.............................................................#............#.....................';
'.................#..................................................................#..#..............#...........................';
'..................#...............................#................#............#...........#......#............#.................';
'.....#......................#..............#.......................#......................#.......................................';
'...............................#.....#.......................#.......#......................#......#............#...........#.....';
'......#.............##....#.....#...............#.....#............................#....................................#.........';
'...#.#.......#..#...##.............................................................#.#.#...........#.....#................#.......';
'...........................................#...#......#...........................................................................';
'.........#.................................#........................................................................#........#.#..';
'........................#..........................................#.......#..............#.......................................';
'....................................................#...............#..........................#..................................';
'............................#................#......#...............#.....................#.......................................';
'#.#............#......................................................................................#.....#.....................';
'................................................................#....#..........................................#........#......#.';
'.......#........#......................................................................#.................#..................#.#...';
'...............................#...#......................................................................#.........#.........#...';
'...........#..#..................##..#.........................................#..............##............................#.....';
'#........#...............#.....#.....#.................#............#....#.............................#.......#.................#';
'...............#...................................................#.......#.......................#......#.............#.........';
'...#............................................................................................................................#.';
'#.....................#......................................................#...........................................#........';
'...........#..........................................#.......................................#.....................#.............';
'....#.##.......#..............#.....#..............................#....................................#.....................#...';
'...............................................................................................................#...............#..';
'.#...........................#...#.....#...#...................#....#........#.........#................................#.........';
'.................#............................................................................#........................#..#.......';
'.............#....#.....................................................#............#.........................#.......#..........';
'#....#........................#....................................................................##.............................';
'...#.#.....................................#...............................................#.....................#....#.........#.';
'.........#..............................#....................................#.................#............#.....................';
'................................................................#.................................................................';
'#.......#..............................................#.............................#...........#................................';
'.#......#.........#.............................#...............................................................#.................';
'.........#.....#......#.......................................................................................................#...';
'#..............................#........#............................#.................................#.....#.....#..............';
'......#.....................................#.......#........#....................................................................';
'#.......#.....................................#......................................................................#............';
'.....................................#......................................#......#.##..................#.....#.#................';
'.......................#.........#......#...........................................................................##............';
'.....#......#.#.................................................#.............................#............#.#.......#............';
'..................#.......................................#.#.............................#..................................#....';
'......................#.......#.....................#...................#......#.........................................#........';
'.........#...................................................................................................#....#...............';
'.........................#...........#..........#...............#.....#...................................................##......';
'#...#......#.#.....................#..................#.................#..................#......................................';
'..............................#.....#................#.....................#............#...#....#............#...#...............';
'.........................#..................#.............................................................................#.......';
'.......#....................#.......................#.....................#..........#...........#..........#...................#.';
'....#..........#..#................#.....#..........#........#..................#.....................##...............#.........#';
'.....................................................................................#......................................#.....';
'.......................................#...................................#.......................#..........................#...';
'.......#...............................#............#.....#..............................................#.................#......';
'.#..........................#..................................................................#...#.#.......#.#..........#.......';
'#...............................................................#.#............................#...............#......#...........';
'...#..........................#.#..#.#.............................................................#......#.......................';
'..................#........#.....................................................#...............................................#';
'....................#.............#.........#........##................#.............#............#..#............................';
'.........................#.................................#...........................................#.....#....................';
'..........................................##..........#................................#........................................#.';
'.................................................................................#..........#....................##........##.....';
'.....###......#.....#...................................................................................#..#...................#..';
'........#.....#.....#.....#..........#.................................................#.#......................#.................';
'...........................................#....#..............#..#..............#................................................';
'....#.............#...................................#.....#........................................................#............';
'.........#........#.............#..................#..........#..........................###.......#....#.#.#.....................';
'..................#....................#...................#...#..................................................................';
'.......#...............#................................................................................#................#........';
'....#..........................#......#....................................#.............#...#......................#...#.........';
'.#..#....................#.....................#.............#...............................#....................#....##.........';
'..#..#........#......#.................##..#.......#....................#.............................................#...........';
'..................#......#.............#.##.................................##.....................................#...#..........';
'.#...##........#........................................................................................#.....#...#....#..........';
'............#........................#............................................#.........#.............#.......................';
'................#......#........#...........................................................#............#........................';
'..............................#.#......#................................#...........#......................................#......';
'...................#...................#.............#............#.............#.................................................';
'.........#.......#....#........#.........#.....................#..#.......#..#...#.............................#..................';
'.........#...#.........................................................................#.....#.......#............................';
'.........................#..........#...............................................#.....................................#....#..';
'....#..................##..##...........#.........#..................................................#...#...........#...........#';
'.......#.......#.....#...............#.#.....#.............#........................#..............................#..#.........#.';
'........................#........................................#.............................##.................................'];

[xx, yy] = find(input == '^');
pp = [xx; yy];
direc = [-1; 0];
ip2 = input;
while true
    pn = pp + direc;
    if pn(1) < 1 || pn(2) < 1 || pn(1) > 130 || pn(2) > 130
        break;
    end
    if input(pn(1), pn(2)) == '#'
        direc = [0 1; -1 0] * direc;
    else
        pp = pn;
        ip2(pn(1), pn(2)) = 'X';
    end
end
numel(find(ip2=='X'))

%%